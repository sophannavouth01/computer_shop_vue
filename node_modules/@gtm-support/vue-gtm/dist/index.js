import{GtmSupport as g,loadScript as m}from"@gtm-support/core";import{nextTick as y}from"vue";import{GtmSupport as T,assertIsGtmId as b,hasScript as I,loadScript as k}from"@gtm-support/core";var i;function c(a,t={id:""}){t={trackOnNextTick:!1,...t},i=new g(t),a.config.globalProperties.$gtm=i,i.isInBrowserContext()&&(t.vueRouter&&G(a,t.vueRouter,t.ignoredViews,t.trackOnNextTick,t.vueRouterAdditionalEventData),i.options.enabled&&i.options.loadScript&&(Array.isArray(t.id)?t.id.forEach(r=>{if(typeof r=="string")m(r,t);else{let n={...t};r.queryParams!=null&&(n.queryParams={...n.queryParams,...r.queryParams}),m(r.id,n)}}):m(t.id,t))),a.provide("gtm",t)}function G(a,t,r=[],n,f=()=>({})){function l(e,u){return e instanceof Error?!!(e.type&u):!1}t.afterEach(async(e,u,p)=>{if(typeof e.name!="string"||Array.isArray(r)&&r.includes(e.name)||typeof r=="function"&&r(e,u))return;let s=e.meta&&typeof e.meta.gtm=="string"&&e.meta.gtm?e.meta.gtm:e.name;l(p,4)?i?.debugEnabled()&&console.log(`[VueGtm]: '${s}' not tracked due to navigation aborted`):l(p,8)&&i?.debugEnabled()&&console.log(`[VueGtm]: '${s}' not tracked due to navigation cancelled`);let d={...await f(e,u),...e.meta?.gtmAdditionalEventData},o=t.options?.history?.base??"";o.endsWith("/")||(o+="/"),o+=e.fullPath.startsWith("/")?e.fullPath.substring(1):e.fullPath,n?y(()=>{i?.trackView(s,o,d)}):i?.trackView(s,o,d)})}function N(a){return{install:t=>c(t,a)}}var v={install:c};var V=v;function E(){return i}export{g as GtmPlugin,T as GtmSupport,b as assertIsGtmId,N as createGtm,V as default,I as hasScript,k as loadScript,E as useGtm};
//# sourceMappingURL=index.js.map