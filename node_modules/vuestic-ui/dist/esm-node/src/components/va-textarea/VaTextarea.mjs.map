{"version":3,"file":"VaTextarea.mjs","sources":["../../../../../src/components/va-textarea/VaTextarea.vue"],"sourcesContent":["<template>\n  <VaInputWrapper\n    class=\"va-textarea\"\n    v-bind=\"vaInputWrapperProps\"\n    :error=\"computedError\"\n    :error-messages=\"computedErrorMessages\"\n  >\n    <div class=\"va-textarea__resize-wrapper\" :class=\"{\n      'va-textarea__resize-wrapper--resizable': isResizable,\n    }\">\n      <textarea\n        v-model=\"valueComputed\"\n        v-bind=\"{ ...computedProps, ...listeners, ...validationAriaAttributes }\"\n        :style=\"computedStyle\"\n        :rows=\"computedRowsCount\"\n        :loading=\"isLoading\"\n        ref=\"textarea\"\n        :ariaLabel=\"$props.label\"\n        class=\"va-textarea__textarea\"\n        @focus=\"validationListeners.onFocus\"\n        @blur=\"validationListeners.onBlur\"\n      />\n    </div>\n  </VaInputWrapper>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, CSSProperties, shallowRef } from 'vue'\nimport pick from 'lodash/pick.js'\nimport { VaInputWrapper } from '../va-input-wrapper'\n\nimport { useFormFieldProps, useEmitProxy, useStateful, useStatefulProps, useValidation, useValidationProps, useValidationEmits } from '../../composables'\nimport { extractComponentProps, filterComponentProps } from '../../utils/component-options'\nimport { blurElement, focusElement } from '../../utils/focus'\n\nconst positiveNumberValidator = (val: number) => {\n  if (val > 0 && (val | 0) === val) {\n    return true\n  }\n  throw new Error(`\\`minRows|maxRows\\` must be a positive integer greater than 0, but ${val} is provided`)\n}\n\nconst { createEmits, createListeners } = useEmitProxy([\n  'input', 'change', 'click', 'update:modelValue',\n])\n\nconst VaInputWrapperProps = extractComponentProps(VaInputWrapper)\n\nexport default defineComponent({\n  name: 'VaTextarea',\n\n  components: { VaInputWrapper },\n\n  props: {\n    ...useFormFieldProps,\n    ...VaInputWrapperProps,\n    ...useStatefulProps,\n    ...useValidationProps,\n    modelValue: { type: [String, Number], default: '' },\n    placeholder: { type: String },\n    autosize: { type: Boolean, default: false },\n    minRows: {\n      type: Number,\n      default: 1,\n      validator: positiveNumberValidator,\n    },\n    maxRows: {\n      type: Number,\n      validator: positiveNumberValidator,\n    },\n    resize: {\n      type: Boolean,\n      default: true,\n    },\n    clearValue: {\n      type: [String],\n      default: '',\n    },\n  },\n\n  emits: [...createEmits(), ...useValidationEmits],\n\n  setup (props, { emit }) {\n    const textarea = shallowRef<HTMLTextAreaElement>()\n    const { valueComputed } = useStateful(props, emit, 'modelValue', {\n      defaultValue: '',\n    })\n\n    const focus = () => {\n      focusElement(textarea.value)\n    }\n\n    const blur = () => {\n      blurElement(textarea.value)\n    }\n\n    const reset = () => withoutValidation(() => {\n      emit('update:modelValue', props.clearValue)\n      emit('clear')\n      resetValidation()\n    })\n\n    const {\n      computedError,\n      computedErrorMessages,\n      listeners: validationListeners,\n      validationAriaAttributes,\n      isLoading,\n      resetValidation,\n      withoutValidation,\n    } = useValidation(props, emit, {\n      value: valueComputed,\n      focus,\n      reset,\n    })\n\n    const isResizable = computed(() => {\n      return props.resize && !props.autosize\n    })\n\n    const computedRowsCount = computed<number | undefined>(() => {\n      if (!props.autosize) {\n        return undefined\n      }\n\n      const rows = valueComputed.value ? valueComputed.value.toString().split('\\n').length : 1\n\n      if (!props.maxRows) {\n        return rows\n      }\n\n      return Math.max(props.minRows, Math.min(rows, props.maxRows))\n    })\n\n    const computedStyle = computed(() => ({\n      resize: isResizable.value ? undefined : 'none',\n    }) as CSSProperties)\n\n    const computedProps = computed(() => ({\n      ...pick(props, ['disabled', 'readonly', 'placeholder', 'ariaLabel']),\n    }))\n\n    return {\n      isResizable,\n      validationListeners,\n      validationAriaAttributes,\n      computedError,\n      computedErrorMessages,\n      isLoading,\n      computedRowsCount,\n      valueComputed,\n      vaInputWrapperProps: filterComponentProps(VaInputWrapperProps),\n      textarea,\n      computedStyle,\n      listeners: createListeners(emit),\n      computedProps,\n      focus,\n      blur,\n    }\n  },\n})\n</script>\n\n<style lang=\"scss\">\n@import '../../styles/resources/index.scss';\n\n.va-textarea {\n  .va-input-wrapper__field {\n    padding-top: 12px;\n    padding-bottom: 12px;\n    align-items: flex-start;\n  }\n\n  &__resize-wrapper {\n    display: flex;\n    overflow: hidden;\n    width: 100%;\n    align-self: stretch;\n\n    &--resizable {\n      resize: vertical;\n    }\n  }\n\n  &__textarea {\n    border: 0;\n    flex: 1;\n    font-family: var(--va-font-family);\n    width: 100%;\n    padding: 1px 0;\n    margin: -1px 0;\n    background: transparent;\n    color: currentColor;\n    box-sizing: content-box;\n    min-height: 1.15rem;\n    outline: none;\n    position: relative;\n    resize: none;\n\n    @include va-scroll(var(--va-secondary));\n  }\n}\n</style>\n"],"names":["_resolveComponent","_openBlock","_createBlock","_mergeProps","_withCtx","_createElementVNode","_withDirectives"],"mappings":";;;;;;AACE,QAAA,4BAAAA,iBAsBiB,gBAtBjB;AAIG,SAAAC,UAAA,GAAgBC,YAAqB,2BAAAC,WAAA,EAAA,OAAA,cAAA,GAAA,KAAA,qBAAA;AAAA,IAAA,OAAA,KAAA;AAAA,sBAEtC,KAeM;AAAA,EAAA,CAfN,GAAA;AAAA,IAAU,SAAAC,QAAA,MAAA;AAAA,MAAAC,mBAAA,OAAA;AAAA;;;;QAKOC,eAAAD,mBAAkB,YAASF,WAAK;AAAA,UAC5C,uBAAO,OAAa,CAAA,MAAA,OAAA,CAAA,IAAA,CAAA,WAAA,KAAA,gBAAA;AAAA,QAAA,GACpB,KAAM,KAAiB,eAAA,GAAA,KAAA,WAAA,GAAA,KAAA,4BAAA;AAAA,UACvB,OAAO,KAAE;AAAA,UACV,MAAI,KAAA;AAAA,UACH,SAAS,KAAE;AAAA,UACZ,KAAK;AAAA,UACJ,WAAK,KAAA,OAAA;AAAA,UACL,OAAI;AAAA,UAAA,SAAA,OAAA,CAAA,MAAA,OAAA,CAAA,IAAA,IAAA,SAAA,KAAA,oBAAA,WAAA,KAAA,oBAAA,QAAA,GAAA,IAAA;AAAA,yBATI,CAAa,MAAA,OAAA,CAAA,IAAA,IAAA,SAAA,KAAA,oBAAA,UAAA,KAAA,oBAAA,OAAA,GAAA,IAAA;AAAA,QAAA,CAAA,GAAA,MAAA,IAAA,UAAA,GAAA;AAAA;;;;;;;;"}